name: Viaanix Deploy Scripts
description: Deploy an AWS SAM Application
author: Viaanix | Kelsi Andrews <kelsi.andrews@viaanix.com>
inputs:
  tags:
    description: 'TODO: ADD' # TODO: ADD
    required: true
#    default:
  region:
    description: 'TODO: ADD' # TODO: ADD
    required: true
    default: us-east-1
  application-name:
    description: 'TODO: ADD' # TODO: ADD
    required: true
    default: NoApplicationNameProvided
  runner-account-id:
    description: 'TODO: ADD' # TODO: ADD
    required: true

#outputs:
#  CreateDeployRole:
#    description: 'TODO: ADD' # TODO: ADD
#  CreateS3Bucket:
#    description: 'TODO: ADD' # TODO: ADD
#  Deploy:
#    description: 'TODO: ADD' # TODO: ADD
#  Docker:
#    description: 'TODO: ADD' # TODO: ADD
#    default:
#    default: ${{ github.token }}
#  working-directory:
#    description: 'Relative path under $GITHUB_WORKSPACE where the repository was checked out.'
#    required: false
#  ref:
#    description: |
#      Git reference (e.g. branch name) from which the changes will be detected.
#      This option is ignored if action is triggered by pull_request event.
#    required: false

#outputs:
#  tbd:
#    description: tbd

runs:
#  entrypoint: ./deploy-scripts/deploy.sh
  using: docker
  image: Dockerfile
  env:
#    ENVIRONMENT: ${{ github.ref == 'main' && 'PROD' || 'DEV' }}
    RUNNER_ACCOUNT_ID: ${{ inputs.runner-account-id }}
#    REPO_URL: ${{ github.server_url}}/${{ github.repository }}
#    ORG_URL: ${{ github.server_url}}
    TAGS: ${{ inputs.tags }}
    REGION: ${{ inputs.region }}
    APPLICATION_NAME: ${{ inputs.application-name }}

#  steps:
#    - name: Setup Env
#      id: SetupEnv
#      run: |
#        LOWERCASE_APPLICATION_NAME="$(echo "${{ env.APPLICATION_NAME }}" | sed -e 's|\([A-Z][^A-Z]\)| \1|g' -e 's|\([a-z]\)\([A-Z]\)|\1 \2|g' | sed 's/^ *//g' | tr '[:upper:]' '[:lower:]' | tr " " "-")-$(echo "${{ env.ENVIRONMENT }}" | tr '[:upper:]' '[:lower:]')"
#        echo "LOWERCASE_APPLICATION_NAME=$LOWERCASE_APPLICATION_NAME" >> $GITHUB_OUTPUT
#        echo "SAM_MANAGED_BUCKET=${LOWERCASE_APPLICATION_NAME}-sam-managed-$(echo "$ENVIRONMENT" | tr '[:upper:]' '[:lower:]')" >> $GITHUB_OUTPUT
#  args:
#branding:
#  color: blue
#  icon: filter